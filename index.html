<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css">
  <title>PIVision_DCA</title>
</head>

<body>
  
  <h1>Olá, estamos compilando as informações!</h1>
  <h1>Aguarde!</h1>
  
<forms name="google-sheet1">
  <table>
      <th colspan="2">INFORMATIONS RECEIVED</th>
      <tr>
        	<td>SAMPLE:</td>
        	<td> <input id="am" name="am"></td>
      </tr>
      <tr>
        	<td>CHEMICAL ANALYSIS:</td>
        	<td><input id="ca" name="ca"></td>
      </tr>
      <tr>
        	<td>REQUEST NUMBER:</td>
        	<td><input id="rn" name="rn"></td>
      </tr>
      
      <tr>
        	<td>EXECUTE</td>
        	<td><input type="submit" value="Execute"></td>
      </tr>
    </table>
  </forms>
  <p id="testes"></p>
    
  <script src="script.js">
    const scriptURL = 'https://script.google.com/a/macros/solvay.com/s/AKfycbzNQp-mdw5_PhrKTgQG9POb_JryelmBYjh8R6tH7xkPY0JJWOFb8VWybriLHl1rYrediA/exec';

    const form = document.forms['google-sheet1'];
  
    form.addEventListener('submit', e=>{
        e.preventDefault()
        fetch(scriptURL,{method: 'POST', body: new FormData(form)})
          .then(Response => $("#form_alerts").html("<div class='alert alert-sucess'>Mensagem enviada com sucesso</div>"))
          .catch(error => $("#form_alerts").html("<div class='alert alert-danger'>Erro ao enviar a mensagem</div>"))
    });
  </script>
</body>
</html>
